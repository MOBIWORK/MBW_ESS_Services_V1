import{q as j,x as w,A as O,aE as A,bR as m,aC as y,aK as Q,az as W,aF as Y,aG as U,s as J,a6 as _,a9 as G,aR as Z,bj as $,aS as ee,aN as L,a$ as z,F as te,aO as M,aU as q,a7 as H,aT as oe,aP as ae,aa as B,ab as le,a_ as ne,aX as V,bS as ue,bT as ie}from"./index-aea319af.js";import{x as re,a as C,b as se,u as ve}from"./use-tracked-pointer-f136af1c.js";import{p as pe}from"./use-tree-walker-388abf0b.js";import{d as de,e as be}from"./use-controllable-f6b0426f.js";function ce(o,R){return o===R}var fe=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(fe||{}),me=(o=>(o[o.Single=0]="Single",o[o.Multi=1]="Multi",o))(me||{}),xe=(o=>(o[o.Pointer=0]="Pointer",o[o.Other=1]="Other",o))(xe||{});let X=Symbol("ComboboxContext");function N(o){let R=le(X,null);if(R===null){let S=new Error(`<${o} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(S,N),S}return R}let Se=j({name:"Combobox",emits:{"update:modelValue":o=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>ce},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(o,{slots:R,attrs:S,emit:I}){let e=w(1),t=w(null),s=w(null),h=w(null),u=w(null),d=w({static:!1,hold:!1}),f=w([]),x=w(null),P=w(1),T=w(!1);function F(l=r=>r){let r=x.value!==null?f.value[x.value]:null,p=ne(l(f.value.slice()),b=>y(b.dataRef.domRef)),n=r?p.indexOf(r):null;return n===-1&&(n=null),{options:p,activeOptionIndex:n}}let D=O(()=>o.multiple?1:0),a=O(()=>o.nullable),[v,c]=de(O(()=>o.modelValue===void 0?A(D.value,{[1]:[],[0]:void 0}):o.modelValue),l=>I("update:modelValue",l),O(()=>o.defaultValue)),i={comboboxState:e,value:v,mode:D,compare(l,r){if(typeof o.by=="string"){let p=o.by;return l?.[p]===r?.[p]}return o.by(l,r)},defaultValue:O(()=>o.defaultValue),nullable:a,inputRef:s,labelRef:t,buttonRef:h,optionsRef:u,disabled:O(()=>o.disabled),options:f,change(l){c(l)},activeOptionIndex:O(()=>{if(T.value&&x.value===null&&f.value.length>0){let l=f.value.findIndex(r=>!r.dataRef.disabled);l!==-1&&(x.value=l)}return x.value}),activationTrigger:P,optionsPropsRef:d,closeCombobox(){T.value=!1,!o.disabled&&e.value!==1&&(e.value=1,x.value=null)},openCombobox(){if(T.value=!0,o.disabled||e.value===0)return;let l=f.value.findIndex(r=>{let p=m(r.dataRef.value);return A(D.value,{[0]:()=>i.compare(m(i.value.value),m(p)),[1]:()=>m(i.value.value).some(n=>i.compare(m(n),m(p)))})});l!==-1&&(x.value=l),e.value=0},goToOption(l,r,p){if(T.value=!1,o.disabled||u.value&&!d.value.static&&e.value===1)return;let n=F();if(n.activeOptionIndex===null){let g=n.options.findIndex(K=>!K.dataRef.disabled);g!==-1&&(n.activeOptionIndex=g)}let b=re(l===C.Specific?{focus:C.Specific,id:r}:{focus:l},{resolveItems:()=>n.options,resolveActiveIndex:()=>n.activeOptionIndex,resolveId:g=>g.id,resolveDisabled:g=>g.dataRef.disabled});x.value=b,P.value=p??1,f.value=n.options},selectOption(l){let r=f.value.find(n=>n.id===l);if(!r)return;let{dataRef:p}=r;c(A(D.value,{[0]:()=>p.value,[1]:()=>{let n=m(i.value.value).slice(),b=m(p.value),g=n.findIndex(K=>i.compare(b,m(K)));return g===-1?n.push(b):n.splice(g,1),n}}))},selectActiveOption(){if(i.activeOptionIndex.value===null)return;let{dataRef:l,id:r}=f.value[i.activeOptionIndex.value];c(A(D.value,{[0]:()=>l.value,[1]:()=>{let p=m(i.value.value).slice(),n=m(l.value),b=p.findIndex(g=>i.compare(n,m(g)));return b===-1?p.push(n):p.splice(b,1),p}})),i.goToOption(C.Specific,r)},registerOption(l,r){let p={id:l,dataRef:r},n=F(b=>[...b,p]);if(x.value===null){let b=r.value.value;A(D.value,{[0]:()=>i.compare(m(i.value.value),m(b)),[1]:()=>m(i.value.value).some(g=>i.compare(m(g),m(b)))})&&(n.activeOptionIndex=n.options.indexOf(p))}f.value=n.options,x.value=n.activeOptionIndex,P.value=1,n.options.some(b=>!y(b.dataRef.domRef))&&requestAnimationFrame(()=>{let b=F();f.value=b.options,x.value=b.activeOptionIndex})},unregisterOption(l){var r;i.activeOptionIndex.value!==null&&((r=i.options.value[i.activeOptionIndex.value])==null?void 0:r.id)===l&&(T.value=!0);let p=F(n=>{let b=n.findIndex(g=>g.id===l);return b!==-1&&n.splice(b,1),n});f.value=p.options,x.value=p.activeOptionIndex,P.value=1}};Q([s,h,u],()=>i.closeCombobox(),O(()=>e.value===0)),W(X,i),Y(O(()=>A(e.value,{[0]:U.Open,[1]:U.Closed})));let k=O(()=>i.activeOptionIndex.value===null?null:f.value[i.activeOptionIndex.value].dataRef.value),E=O(()=>{var l;return(l=y(s))==null?void 0:l.closest("form")});return J(()=>{_([E],()=>{if(!E.value||o.defaultValue===void 0)return;function l(){i.change(o.defaultValue)}return E.value.addEventListener("reset",l),()=>{var r;(r=E.value)==null||r.removeEventListener("reset",l)}},{immediate:!0})}),()=>{let{name:l,disabled:r,form:p,...n}=o,b={open:e.value===0,disabled:r,activeIndex:i.activeOptionIndex.value,activeOption:k.value,value:v.value};return G(te,[...l!=null&&v.value!=null?be({[l]:v.value}).map(([g,K])=>G(Z,$({features:ee.Hidden,key:g,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:p,name:g,value:K}))):[],L({theirProps:{...S,...z(n,["modelValue","defaultValue","nullable","multiple","onUpdate:modelValue","by"])},ourProps:{},slot:b,slots:R,attrs:S,name:"Combobox"})])}}});j({name:"ComboboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:()=>`headlessui-combobox-label-${M()}`}},setup(o,{attrs:R,slots:S}){let I=N("ComboboxLabel");function e(){var t;(t=y(I.inputRef))==null||t.focus({preventScroll:!0})}return()=>{let t={open:I.comboboxState.value===0,disabled:I.disabled.value},{id:s,...h}=o,u={id:s,ref:I.labelRef,onClick:e};return L({ourProps:u,theirProps:h,slot:t,attrs:R,slots:S,name:"ComboboxLabel"})}}});let Ce=j({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-combobox-button-${M()}`}},setup(o,{attrs:R,slots:S,expose:I}){let e=N("ComboboxButton");I({el:e.buttonRef,$el:e.buttonRef});function t(u){e.disabled.value||(e.comboboxState.value===0?e.closeCombobox():(u.preventDefault(),e.openCombobox()),B(()=>{var d;return(d=y(e.inputRef))==null?void 0:d.focus({preventScroll:!0})}))}function s(u){switch(u.key){case V.ArrowDown:u.preventDefault(),u.stopPropagation(),e.comboboxState.value===1&&e.openCombobox(),B(()=>{var d;return(d=e.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return;case V.ArrowUp:u.preventDefault(),u.stopPropagation(),e.comboboxState.value===1&&(e.openCombobox(),B(()=>{e.value.value||e.goToOption(C.Last)})),B(()=>{var d;return(d=e.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return;case V.Escape:if(e.comboboxState.value!==0)return;u.preventDefault(),e.optionsRef.value&&!e.optionsPropsRef.value.static&&u.stopPropagation(),e.closeCombobox(),B(()=>{var d;return(d=e.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return}}let h=se(O(()=>({as:o.as,type:R.type})),e.buttonRef);return()=>{var u,d;let f={open:e.comboboxState.value===0,disabled:e.disabled.value,value:e.value.value},{id:x,...P}=o,T={ref:e.buttonRef,id:x,type:h.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(u=y(e.optionsRef))==null?void 0:u.id,"aria-expanded":e.disabled.value?void 0:e.comboboxState.value===0,"aria-labelledby":e.labelRef.value?[(d=y(e.labelRef))==null?void 0:d.id,x].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:s,onClick:t};return L({ourProps:T,theirProps:P,slot:f,attrs:R,slots:S,name:"ComboboxButton"})}}}),he=j({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:()=>`headlessui-combobox-input-${M()}`}},emits:{change:o=>!0},setup(o,{emit:R,attrs:S,slots:I,expose:e}){let t=N("ComboboxInput"),s={value:!1};e({el:t.inputRef,$el:t.inputRef});let h=O(()=>{var a;let v=t.value.value;return y(t.inputRef)?typeof o.displayValue<"u"&&v!==void 0?(a=o.displayValue(v))!=null?a:"":typeof v=="string"?v:"":""});J(()=>{_([h,t.comboboxState],([a,v],[c,i])=>{if(s.value)return;let k=y(t.inputRef);k&&(i===0&&v===1||a!==c)&&(k.value=a)},{immediate:!0}),_([t.comboboxState],([a],[v])=>{if(a===0&&v===1){let c=y(t.inputRef);if(!c)return;let i=c.value,{selectionStart:k,selectionEnd:E,selectionDirection:l}=c;c.value="",c.value=i,l!==null?c.setSelectionRange(k,E,l):c.setSelectionRange(k,E)}})});let u=w(!1),d=w(null);function f(){u.value=!0}function x(){ue().nextFrame(()=>{u.value=!1,d.value&&(t.openCombobox(),R("change",d.value),d.value=null)})}function P(a){switch(s.value=!0,a.key){case V.Backspace:case V.Delete:if(t.mode.value!==0||!t.nullable.value)return;let v=a.currentTarget;requestAnimationFrame(()=>{if(v.value===""){t.change(null);let c=y(t.optionsRef);c&&(c.scrollTop=0),t.goToOption(C.Nothing)}});break;case V.Enter:if(s.value=!1,t.comboboxState.value!==0||u.value)return;if(a.preventDefault(),a.stopPropagation(),t.activeOptionIndex.value===null){t.closeCombobox();return}t.selectActiveOption(),t.mode.value===0&&t.closeCombobox();break;case V.ArrowDown:return s.value=!1,a.preventDefault(),a.stopPropagation(),A(t.comboboxState.value,{[0]:()=>t.goToOption(C.Next),[1]:()=>t.openCombobox()});case V.ArrowUp:return s.value=!1,a.preventDefault(),a.stopPropagation(),A(t.comboboxState.value,{[0]:()=>t.goToOption(C.Previous),[1]:()=>{t.openCombobox(),B(()=>{t.value.value||t.goToOption(C.Last)})}});case V.Home:if(a.shiftKey)break;return s.value=!1,a.preventDefault(),a.stopPropagation(),t.goToOption(C.First);case V.PageUp:return s.value=!1,a.preventDefault(),a.stopPropagation(),t.goToOption(C.First);case V.End:if(a.shiftKey)break;return s.value=!1,a.preventDefault(),a.stopPropagation(),t.goToOption(C.Last);case V.PageDown:return s.value=!1,a.preventDefault(),a.stopPropagation(),t.goToOption(C.Last);case V.Escape:if(s.value=!1,t.comboboxState.value!==0)return;a.preventDefault(),t.optionsRef.value&&!t.optionsPropsRef.value.static&&a.stopPropagation(),t.closeCombobox();break;case V.Tab:if(s.value=!1,t.comboboxState.value!==0)return;t.mode.value===0&&t.selectActiveOption(),t.closeCombobox();break}}function T(a){if(u.value){d.value=a;return}t.openCombobox(),R("change",a)}function F(){s.value=!1}let D=O(()=>{var a,v,c,i;return(i=(c=(v=o.defaultValue)!=null?v:t.defaultValue.value!==void 0?(a=o.displayValue)==null?void 0:a.call(o,t.defaultValue.value):null)!=null?c:t.defaultValue.value)!=null?i:""});return()=>{var a,v,c,i,k,E;let l={open:t.comboboxState.value===0},{id:r,displayValue:p,onChange:n,...b}=o,g={"aria-controls":(a=t.optionsRef.value)==null?void 0:a.id,"aria-expanded":t.disabled.value?void 0:t.comboboxState.value===0,"aria-activedescendant":t.activeOptionIndex.value===null||(v=t.options.value[t.activeOptionIndex.value])==null?void 0:v.id,"aria-labelledby":(k=(c=y(t.labelRef))==null?void 0:c.id)!=null?k:(i=y(t.buttonRef))==null?void 0:i.id,"aria-autocomplete":"list",id:r,onCompositionstart:f,onCompositionend:x,onKeydown:P,onInput:T,onBlur:F,role:"combobox",type:(E=S.type)!=null?E:"text",tabIndex:0,ref:t.inputRef,defaultValue:D.value,disabled:t.disabled.value===!0?!0:void 0};return L({ourProps:g,theirProps:b,slot:l,attrs:S,slots:I,features:q.RenderStrategy|q.Static,name:"ComboboxInput"})}}}),Ie=j({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(o,{attrs:R,slots:S,expose:I}){let e=N("ComboboxOptions"),t=`headlessui-combobox-options-${M()}`;I({el:e.optionsRef,$el:e.optionsRef}),H(()=>{e.optionsPropsRef.value.static=o.static}),H(()=>{e.optionsPropsRef.value.hold=o.hold});let s=oe(),h=O(()=>s!==null?(s.value&U.Open)===U.Open:e.comboboxState.value===0);return pe({container:O(()=>y(e.optionsRef)),enabled:O(()=>e.comboboxState.value===0),accept(u){return u.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:u.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(u){u.setAttribute("role","none")}}),()=>{var u,d,f;let x={open:e.comboboxState.value===0},P={"aria-labelledby":(f=(u=y(e.labelRef))==null?void 0:u.id)!=null?f:(d=y(e.buttonRef))==null?void 0:d.id,id:t,ref:e.optionsRef,role:"listbox","aria-multiselectable":e.mode.value===1?!0:void 0},T=z(o,["hold"]);return L({ourProps:P,theirProps:T,slot:x,attrs:R,slots:S,features:q.RenderStrategy|q.Static,visible:h.value,name:"ComboboxOptions"})}}}),Pe=j({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(o,{slots:R,attrs:S,expose:I}){let e=N("ComboboxOption"),t=`headlessui-combobox-option-${M()}`,s=w(null);I({el:s,$el:s});let h=O(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===t:!1),u=O(()=>A(e.mode.value,{[0]:()=>e.compare(m(e.value.value),m(o.value)),[1]:()=>m(e.value.value).some(a=>e.compare(m(a),m(o.value)))})),d=O(()=>({disabled:o.disabled,value:o.value,domRef:s}));J(()=>e.registerOption(t,d)),ae(()=>e.unregisterOption(t)),H(()=>{e.comboboxState.value===0&&h.value&&e.activationTrigger.value!==0&&B(()=>{var a,v;return(v=(a=y(s))==null?void 0:a.scrollIntoView)==null?void 0:v.call(a,{block:"nearest"})})});function f(a){if(o.disabled)return a.preventDefault();e.selectOption(t),e.mode.value===0&&e.closeCombobox(),ie()||requestAnimationFrame(()=>{var v;return(v=y(e.inputRef))==null?void 0:v.focus()})}function x(){if(o.disabled)return e.goToOption(C.Nothing);e.goToOption(C.Specific,t)}let P=ve();function T(a){P.update(a)}function F(a){P.wasMoved(a)&&(o.disabled||h.value||e.goToOption(C.Specific,t,0))}function D(a){P.wasMoved(a)&&(o.disabled||h.value&&(e.optionsPropsRef.value.hold||e.goToOption(C.Nothing)))}return()=>{let{disabled:a}=o,v={active:h.value,selected:u.value,disabled:a},c={id:t,ref:s,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":u.value,disabled:void 0,onClick:f,onFocus:x,onPointerenter:T,onMouseenter:T,onPointermove:F,onMousemove:F,onPointerleave:D,onMouseleave:D};return L({ourProps:c,theirProps:o,slot:v,attrs:S,slots:R,name:"ComboboxOption"})}}});export{Pe as J,Se as K,Ce as U,he as _,Ie as q};
