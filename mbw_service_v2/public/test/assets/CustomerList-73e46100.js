import{_ as B,D as h,I as N,A as V,o as v,b as y,j as s,w as f,a as i,h as g,q as x,ak as I,al as S,c as b,y as l,t as D,p as k,E as U,ao as E,x as C,ad as H}from"./index-aea319af.js";import{_ as $}from"./Avatar.vue_vue_type_script_setup_true_lang-827ced2f.js";import{c as q}from"./notification-c4068361.js";import{_ as z}from"./PageTitle.vue_vue_type_script_setup_true_lang-98ef5881.js";import{_ as A}from"./plus-d3fdba1e.js";import{_ as M}from"./LV.vue_vue_type_script_setup_true_lang-2ffe76d5.js";import"./iconify-d47d89f2.js";import{F as R}from"./FileUploader-68858d98.js";import{u as F}from"./error-bdedfa48.js";import"./EmptyMessage.vue_vue_type_script_setup_true_lang-fbb9efd4.js";import"./label-bdf4c41a.js";import"./use-tree-walker-388abf0b.js";import"./use-controllable-f6b0426f.js";const L={name:"NewCustomerDialog",components:{Dialog:h,Input:N},props:{modelValue:{type:Boolean,required:!0}},setup(u,{emit:o}){return{open:V({get:()=>u.modelValue,set:t=>{o("update:modelValue",t),t||o("close")}})}},data(){return{customer:"",domain:""}},methods:{addCustomer(){const u={customer_name:this.customer,domain:this.domain};this.$resources.newCustomer.submit({doc:{doctype:"HD Customer",...u}})},close(){this.customer="",this.domain="",this.$emit("close")}},resources:{newCustomer(){return{url:"frappe.client.insert",onSuccess:u=>{this.$router.push("/customers")}}}}},P={class:"space-y-4"},T={class:"space-y-1"},j={class:"space-y-1"},G={class:"float-right flex space-x-2"};function J(u,o,a,t,c,d){const p=g("Input"),n=g("Button"),e=g("Dialog");return v(),y("div",null,[s(e,{modelValue:t.open,"onUpdate:modelValue":o[3]||(o[3]=r=>t.open=r),options:{title:"Add New Customer",size:"sm"}},{"body-content":f(()=>[i("div",P,[i("div",T,[s(p,{modelValue:c.customer,"onUpdate:modelValue":o[0]||(o[0]=r=>c.customer=r),label:"Customer Name",type:"text",placeholder:"Tesla Inc."},null,8,["modelValue"])]),i("div",j,[s(p,{modelValue:c.domain,"onUpdate:modelValue":o[1]||(o[1]=r=>c.domain=r),label:"Domain",type:"text",placeholder:"eg: tesla.com, mycompany.com"},null,8,["modelValue"])]),i("div",G,[s(n,{label:"Add",theme:"gray",variant:"solid",onClick:o[2]||(o[2]=()=>{d.addCustomer(),d.close(),u.$router.go()})})])])]),_:1},8,["modelValue"])])}const K=B(L,[["render",J]]),O={class:"flex flex-col items-center gap-4 p-6"},Q={class:"text-xl font-medium text-gray-900"},W={class:"flex gap-2"},X=["onSubmit"],Y=x({__name:"CustomerDialog",props:{name:{type:String,required:!0}},setup(u){const o=u,a=V({get(){return t.doc?.domain},set(n){t.doc.domain=n}}),t=I({doctype:"HD Customer",name:o.name,auto:!0,setValue:{onSuccess(){S({title:"Customer updated",icon:"check",iconClasses:"text-green-500"})},onError:F({title:"Error updating customer"})}}),c=V(()=>({title:t.doc?.name,actions:[{label:"Save",theme:"gray",variant:"solid",onClick:()=>d()}]}));function d(){t.setValue.submit({domain:a.value})}function p(n){t.setValue.submit({image:n?.file_url||null})}return(n,e)=>{const r=g("Button"),m=g("Input");return v(),b(l(h),{options:l(c)},{"body-main":f(()=>[i("div",O,[i("div",Q,D(l(t).doc?.name),1),s(l($),{size:"lg",label:l(t).doc?.name,image:l(t).doc?.image,class:"cursor-pointer hover:opacity-80"},null,8,["label","image"]),i("div",W,[s(l(R),{onSuccess:e[0]||(e[0]=_=>p(_))},{default:f(({uploading:_,openFileSelector:w})=>[s(r,{label:l(t).doc?.image?"Change photo":"Upload photo",loading:_,onClick:w},null,8,["label","loading","onClick"])]),_:1}),l(t).doc?.image?(v(),b(r,{key:0,label:"Remove photo",onClick:e[1]||(e[1]=_=>p(null))})):k("",!0)]),i("form",{class:"w-full",onSubmit:U(d,["prevent"])},[s(m,{modelValue:l(a),"onUpdate:modelValue":e[2]||(e[2]=_=>E(a)?a.value=_:null),label:"Domain",placeholder:"example.com"},null,8,["modelValue"])],40,X)])]),_:1},8,["options"])}}}),Z={class:"flex flex-col"},ee={class:"flex items-center gap-2"},oe={class:"line-clamp-1"},te={key:0},ge=x({__name:"CustomerList",setup(u){const o=C(!1),a=C(!1),t=C(null),c=[{label:"Name",key:"name",width:"w-80"},{label:"Domain",key:"domain",width:"w-80"}],d=q({doctype:"HD Customer",fields:["name","image","domain"],auto:!0,transform:n=>{for(const e of n)e.onClick=()=>p(e.name);return n}});H(()=>({title:"Customers"}));function p(n){t.value=n,a.value=!0}return(n,e)=>{const r=g("Button");return v(),y("div",Z,[s(z,{title:"Customers"},{right:f(()=>[s(r,{label:"New customer",theme:"gray",variant:"solid",onClick:e[0]||(e[0]=m=>o.value=!o.value)},{prefix:f(()=>[s(l(A),{class:"h-4 w-4"})]),_:1})]),_:1}),s(l(M),{columns:c,resource:l(d),class:"mt-2.5",doctype:"HD Customer"},{name:f(({data:m})=>[i("div",ee,[s(l($),{label:m.name,image:m.image,size:"sm"},null,8,["label","image"]),i("div",oe,D(m.name),1)])]),_:1},8,["resource"]),s(K,{modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=m=>o.value=m),onClose:e[2]||(e[2]=m=>o.value=!1)},null,8,["modelValue"]),a.value?(v(),y("span",te,[s(Y,{modelValue:a.value,"onUpdate:modelValue":e[3]||(e[3]=m=>a.value=m),name:t.value},null,8,["modelValue","name"])])):k("",!0)])}}});export{ge as default};
