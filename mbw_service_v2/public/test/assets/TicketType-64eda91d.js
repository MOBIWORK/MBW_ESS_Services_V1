import{_ as $}from"./TextEditor.vue_vue_type_script_setup_true_lang-eedae8e3.js";import{_}from"./Autocomplete-e03bcc12.js";import{_ as f,aq as b,I as E,ap as C,x as T,o as u,b as d,a as s,j as o,w as l,f as D,p as B,h as p,l as k}from"./index-aea319af.js";import{T as N}from"./TextEditor-107feeaf.js";import"./notification-c4068361.js";import"./error-bdedfa48.js";import"./iconify-d47d89f2.js";import"./UserAvatar.vue_vue_type_script_setup_true_lang-254c9b2b.js";import"./Avatar.vue_vue_type_script_setup_true_lang-827ced2f.js";import"./combobox-3f3680f7.js";import"./use-tracked-pointer-f136af1c.js";import"./use-tree-walker-388abf0b.js";import"./use-controllable-f6b0426f.js";const M={name:"TicketTypeInfo",components:{FeatherIcon:b,Input:E,Autocomplete:_,TextEditor:N,ErrorMessage:C},props:["ticketTypeId"],setup(){const e=T({title:"",priority:"",description:""}),t=T({title:""});return{newTicketTypeValues:e,ticketTypeInputErrors:t}},computed:{ticketType(){if(this.ticketTypeId){const e=this.$resources.ticketType.doc;return e&&(this.newTicketTypeValues.title=e.name,this.newTicketTypeValues.priority=e.priority,this.newTicketTypeValues.description=e.description),e}else return{title:"",description:"",priority:""}}},resources:{ticketType(){if(this.ticketTypeId)return{type:"document",doctype:"HD Ticket Type",name:this.ticketTypeId,setValue:{onSuccess:()=>{this.$toast({title:"Ticket Type Updated.",icon:"check",iconClasses:"text-green-500"})},onError:e=>{this.$toast({title:"Error while updating ticket type",text:e,icon:"x",iconClasses:"text-red-500"})}}}},renameTicketTypeDoc(){return{url:"frappe.client.rename_doc",onSuccess:e=>{this.$router.push({path:`/ticket-types/${e}`})}}},newTicketType(){return{url:"frappe.client.insert",onSuccess:e=>{this.$router.push({path:`/ticket-types/${e.name}`})}}}},methods:{validate(){return this.newTicketTypeValues.title===""?(this.ticketTypeInputErrors.title="Ticket Type name is required",!1):this.newTicketTypeValues.title=="new"?(this.ticketTypeInputErrors.title="Ticket Type name cannot be 'new'",!1):!0},save(){const e=this.ticketType.name,t=this.newTicketTypeValues.title,n=this.newTicketTypeValues;this.ticketTypeId?this.$resources.ticketType.setValue.submit({priority:n.priority,description:n.description}).then(()=>{t!=e&&this.$resources.renameTicketTypeDoc.submit({doctype:"HD Ticket Type",old_name:e,new_name:t})}):this.$resources.newTicketType.submit({doc:{doctype:"HD Ticket Type",name:n.title,description:n.description,priority:n.priority}})},cancel(){this.$router.go()}}},H={class:"min-w-[490px] px-[24px] py-[10px]"},S={class:"flow-root h-[72px] shrink-0 py-[22px] px-[16px]"},F={class:"float-left"},q=s("div",null,"Back to ticket type list",-1),A={class:"float-right"},L={class:"flex flex-row space-x-2"},P={key:0,class:"flex h-full flex-row space-x-[24px] border-t px-[16px] py-[22px]"},R={class:"flex h-full w-full flex-col space-y-[16px]"},j={class:"w-full space-y-1"},z=s("div",null,[s("span",{class:"block text-sm leading-4 text-gray-700"}," Priority ")],-1),U={class:"flex flex-col"},G=s("div",{class:"mb-2 block text-sm leading-4 text-gray-700"}," Description ",-1);function J(e,t,n,c,x,r){const a=p("FeatherIcon"),v=p("RouterLink"),y=p("Button"),w=p("Input"),g=p("ErrorMessage"),I=_,V=$;return u(),d("div",H,[s("div",S,[s("div",F,[o(v,{to:"/ticket-types",class:"my-1 flex select-none flex-row items-center space-x-1 stroke-gray-600 text-sm text-gray-600 hover:stroke-gray-700 hover:text-gray-700",role:"button"},{default:l(()=>[o(a,{name:"arrow-left",class:"h-[13px] w-[13px]"}),q]),_:1})]),s("div",A,[s("div",L,[o(y,{appearance:"secondary",onClick:t[0]||(t[0]=i=>r.cancel())},{default:l(()=>[k(" Cancel ")]),_:1}),o(y,{appearance:"primary",onClick:t[1]||(t[1]=()=>{r.validate()&&r.save()})},{default:l(()=>[k(" Save ")]),_:1})])])]),r.ticketType?(u(),d("div",P,[s("div",R,[s("div",null,[o(w,{label:"Title",type:"text",value:r.ticketType.name,onInput:t[2]||(t[2]=i=>{c.newTicketTypeValues.title=i})},null,8,["value"]),o(g,{message:c.ticketTypeInputErrors.title},null,8,["message"])]),s("div",j,[z,o(I,{value:c.newTicketTypeValues.priority,"resource-options":{url:"helpdesk.extends.client.get_list",inputMap:i=>({doctype:"HD Ticket Priority",pluck:"name",filters:[["name","like",`%${i}%`]]}),responseMap:i=>i.map(m=>({label:m.name,value:m.name}))},onChange:t[3]||(t[3]=i=>{i&&(c.newTicketTypeValues.priority=i.value)})},null,8,["value","resource-options"])]),s("div",U,[G,o(V,{ref:"textEditor",class:D("bg-gray-100"),"editor-class":"min-h-[20rem] overflow-y-auto max-h-[73vh] px-3 max-w-full",content:r.ticketType.description,"starterkit-options":{heading:{levels:[2,3,4,5,6]}},onChange:t[4]||(t[4]=i=>{c.newTicketTypeValues.description=i})},null,8,["content"])])])])):B("",!0)])}const h=f(M,[["render",J]]),K={name:"TicketType",components:{TicketTypeInfo:h},props:["id"],mounted(){this.$event.emit("set-selected-setting","Ticket Types")}},O={class:"flex flex-col"};function Q(e,t,n,c,x,r){const a=h;return u(),d("div",O,[o(a,{"ticket-type-id":n.id},null,8,["ticket-type-id"])])}const ae=f(K,[["render",Q]]);export{ae as default};
