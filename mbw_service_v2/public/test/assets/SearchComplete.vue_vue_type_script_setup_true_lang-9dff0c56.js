import{_ as $,P as A,i as T,aq as j,h as c,o as l,c as _,w as f,j as b,r as v,n as C,g as q,a as u,f as V,b as d,t as y,aw as k,F as O,d as F,p as S,l as z,ax as P,q as D,ag as J,A as K,x as R,y as L}from"./index-aea319af.js";import{K as E,_ as M,q as Q,J as G,U as H}from"./combobox-3f3680f7.js";const W={name:"Autocomplete",props:["modelValue","options","placeholder"],emits:["update:modelValue","update:query","change"],components:{Popover:A,Button:T,FeatherIcon:j,Combobox:E,ComboboxInput:M,ComboboxOptions:Q,ComboboxOption:G,ComboboxButton:H},data(){return{query:"",showOptions:!1}},computed:{valuePropPassed(){return"value"in this.$attrs},selectedValue:{get(){return this.valuePropPassed?this.$attrs.value:this.modelValue},set(t){this.query="",t&&(this.showOptions=!1),this.$emit(this.valuePropPassed?"change":"update:modelValue",t)}},groups(){return!this.options||this.options.length==0?[]:(this.options[0]?.group?this.options:[{group:"",items:this.options}]).map((e,r)=>({key:r,group:e.group,hideLabel:e.hideLabel||!1,items:this.filterOptions(e.items)})).filter(e=>e.items.length>0)}},watch:{query(t){this.$emit("update:query",t)},showOptions(t){t&&this.$nextTick(()=>{this.$refs.search.el.focus()})}},methods:{filterOptions(t){return this.query?t.filter(e=>[e.label,e.value].some(n=>(n||"").toString().toLowerCase().includes(this.query.toLowerCase()))):t},displayValue(t){return typeof t=="string"?this.groups.flatMap(n=>n.items).find(n=>n.value===t)?.label||t:t?.label}}},X={class:"w-full"},Y=["onClick"],Z={class:"flex items-center"},ee={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},te={key:1,class:"text-base leading-5 text-gray-500"},se={class:"sticky top-0 z-10 flex items-stretch space-x-1.5 bg-white pt-1.5"},oe={class:"relative w-full"},ae={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-gray-500"},le={key:0,class:"rounded-md px-2.5 py-1.5 text-base text-gray-600"};function re(t,e,r,n,i,o){const a=c("FeatherIcon"),p=c("ComboboxInput"),m=c("ComboboxOption"),B=c("ComboboxOptions"),I=c("Popover"),N=c("Combobox");return l(),_(N,{modelValue:o.selectedValue,"onUpdate:modelValue":e[3]||(e[3]=x=>o.selectedValue=x),nullable:""},{default:f(({open:x})=>[b(I,{class:"w-full",show:i.showOptions,"onUpdate:show":e[2]||(e[2]=h=>i.showOptions=h)},{target:f(({open:h,togglePopover:s})=>[v(t.$slots,"target",C(q({open:h,togglePopover:s})),()=>[u("div",X,[u("button",{class:V(["flex h-7 w-full items-center gap-2 justify-between rounded bg-gray-100 py-1 px-2 transition-colors hover:bg-gray-200 focus:ring-2 focus:ring-gray-400",{"bg-gray-200":x}]),onClick:()=>s()},[u("div",Z,[v(t.$slots,"prefix"),o.selectedValue?(l(),d("span",ee,y(o.displayValue(o.selectedValue)),1)):(l(),d("span",te,y(r.placeholder||""),1))]),b(a,{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,Y)])])]),body:f(({isOpen:h})=>[k(u("div",null,[b(B,{class:"mt-1 max-h-[15rem] overflow-y-auto rounded-lg bg-white px-1.5 pb-1.5 shadow-2xl",static:""},{default:f(()=>[u("div",se,[u("div",oe,[b(p,{ref:"search",class:"form-input w-full",type:"text",onChange:e[0]||(e[0]=s=>{i.query=s.target.value}),value:i.query,autocomplete:"off",placeholder:"Search"},null,8,["value"]),u("button",{class:"absolute right-0 inline-flex h-7 w-7 items-center justify-center",onClick:e[1]||(e[1]=s=>o.selectedValue=null)},[b(a,{name:"x",class:"w-4"})])])]),(l(!0),d(O,null,F(o.groups,s=>k((l(),d("div",{class:"mt-1.5",key:s.key},[s.group&&!s.hideLabel?(l(),d("div",ae,y(s.group),1)):S("",!0),(l(!0),d(O,null,F(s.items,g=>(l(),_(m,{as:"template",key:g.value,value:g},{default:f(({active:w,selected:U})=>[u("li",{class:V(["flex items-center rounded px-2.5 py-1.5 text-base",{"bg-gray-100":w}])},[v(t.$slots,"item-prefix",C(q({active:w,selected:U,option:g}))),z(" "+y(g.label),1)],2)]),_:2},1032,["value"]))),128))])),[[P,s.items.length>0]])),128)),o.groups.length==0?(l(),d("li",le," No results found ")):S("",!0)]),_:3})],512),[[P,h]])]),_:2},1032,["show"])]),_:3},8,["modelValue"])}const ne=$(W,[["render",re]]),de=D({__name:"SearchComplete",props:{value:{type:String,required:!1,default:""},doctype:{type:String,required:!0},searchField:{type:String,required:!1,default:"name"},labelField:{type:String,required:!1,default:"name"},valueField:{type:String,required:!1,default:"name"},pageLength:{type:Number,required:!1,default:10}},setup(t){const e=t,r=J({doctype:e.doctype,pageLength:e.pageLength,auto:!0,fields:[e.labelField,e.searchField,e.valueField],onSuccess:()=>{i.value=e.value?n.value.find(a=>a.value===e.value):null}}),n=K(()=>r.data?.map(a=>({label:a[e.labelField],value:a[e.valueField]}))||[]),i=R(null);function o(a){r.update({filters:{[e.searchField]:["like",`%${a}%`]}}),r.reload()}return(a,p)=>(l(),_(L(ne),{placeholder:"Select an option",options:L(n),value:i.value,"onUpdate:query":p[0]||(p[0]=m=>o(m)),onChange:p[1]||(p[1]=m=>i.value=m)},null,8,["options","value"]))}});export{ne as A,de as _};
